# Architecture
---
## Hexagonal Architecture
```
클린 아키텍처 이전에 나온 관심사의 분리에 초점을 둔 아키텍처
```
도메인의 비즈니스 로직을 외부 라이브러리 및 툴로부터 분리 할 때 포트와 어댑터라고 부르는 인터페이스를 사용하기 때문에 `포트 & 어댑터`아키텍처라고도 부른다

---
### 특징
- `관심사 분리`   
비즈니스 로직을 외부 종속에서 분리하는데 중점을 둔다 

- `코어 중심 설계`   
핵심 어플리케이션을 아키텍처 중심에 두어 도메인 모델과 비즈니스 로직을 캡슐화하는 동시에 외부 시스템과 인터페이스는 포트와 어댑터를 통해 연결이 된다

- `유연성 및 적응성`   
느슨한 결으로 핵심 기능에 영향을 주지 않고 어댑터를 쉽게 교체하거나 수정할 수 있다

---
### 장단점
**장점**   
- `도메인 비즈니스 모델에 집중`   
DIP를 통해 의존성이 도메인에서 밖으로 나가는 부분이 없으므로 외부 요소를 신경쓰며 개발 할 필요가 없다

- `모듈 일부를 배포하는게 용이`   
기술과 실제 비즈니스로직의 분리, 각 도메인 별 비즈니스로직 분리를 통해 느슨한 결합을 가져간다

- `쉬운 테스트 구성`   
모든 외부 기술들을 포트를 통해 비즈니스 로직과 연결되기 때문에, 본인의 역할을 수행하기 위해 필요한 Port만 사용하여 모킹 어댑터를 통해 테스트를 쉽게 수행할 수 있다

- `개발비용이 감소`   
모든 의존성이 도메인을 향하기 때문에 계층간 의존성이 낮아지고 유연해지기 때문에 요구사항에 빠르게 대처할 수 있다

- `SoC(관심사 분리)의 장점`   
외부와의 연결에 문제가 생기면 Adapter를 확인하면 될 것이고, 인터페이스의 정의를 변경하고자 한다면 Port를, 비즈니스 로직이 제대로 동작하지 않는다면 도메인 로직만 확인하면 된다
때문에 결국 쉬운 테스트를 가능하게 해주기도 한다

**단점**   
- `코드가 많아짐`   
도메인 계층이 영속성, UI 같은 외부계층과 철저히 분리되어야 하기 때문에 엔티티에 대한 모댈을 각 계층에서 유지 보수 해야한다

- `불필요한 오버헤드`   
아키텍처를 도입하기 전 포트, 어댑터 등 알아야할 개념이 생기고, 아키텍처를 구현하기 위해서는 포트(인터페이스)를 생성해야 하고 도메인 모델의 여러 표현 사이를 매핑할 객체를 만들어야 한다

---
### 구성
`내부(도메인)`와 `외부(인프라)`로 구분된다
```
내부 - 순수한 비즈니스 로직을 표현하며 캡슐화된 영역이고 기능적 요구사항에 따라 먼저 설계
외부 - 내부 영역에서 기술을 분리하여 구성한 영역이고 내부 영역 설계 이후 설계
```
![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FtUu8e%2FbtrZboajmwm%2FI7a6ea13LeLfjdvHcCAk3K%2Fimg.png)   

**포트와 어댑터**   

- `포트`   
Port는 application 입장에서 consumer, 또는 application에서 나가거나 / 들어오는 `end point`라고 볼 수 있다   
포트는 내부 비즈니스 영역을 `외부 영역에 노출한 API`이고 인바운드(Inbound) / 아웃바운드(Outbound) 포트로 구분한다
    ```
    인바운드 포트 - 내부 영역 사용을 위해 노출된 API
    아웃바운드 포트 - 내부 영역이 외부 영역을 사용하기 위한 API
    ```

- `어댑터`   
인프라나 web과 같은 저수준 layer들이 도메인 로직에 접근할 수 있는 포트를 사용할 수 있도록 한다

- `Primary (Driving) Adapters`   
위의 다이어그램에서 왼쪽에 있는 adapter, application을 동작시키는(Driving) 역할을 한다
Driving Adapter에는 주로 UI 쪽이 들어가고 인바운드 포트를 사용한다

- `Secondary (Driven) Adapters`   
위의 다이어그램에 있는 adapter, application에 의해 동작되는 (Driven) 역할을 가진 부분이다
주로 인프라와 연결되는 부분이 들어가고 아웃바운드 포트를 사용한다

Primary adapter에 의해 Secondary adapter들이 호출된다

---