# DATEBASE
---
## DB 종류
- 관계형 데이터베이스
    - Oracle
    - Mysql
    - MS_SQL
    - PostgreSQL
    - Maria DB

- NoSQL (Not Only SQL)
    - Mongodb
    - cassandra
    - hbase


> 데이터베이스 관리 시스템
database management system, DBMS -> 다수의 사용자들이 데이터베이스 내의 데이터를 접근 할 수 있도록 해주는 소프트웨어 도구의 집합
---
### 장점
- 관계형 데이터베이스 (RDBMS)   
    - 업무 변화에 대한 적응력이 높아 변화하는 업무에 쉽게 활용하며 유지보수가 편리하다 -> 생산성 향상   

    - 명확하게 스키마가 정의되어 있다   
    - 데이터 무결성을 보장한다   
    - ACID를 준수한다   
    - 일관된 데이터 데이터 시스템에 적합하다   
    - 지원옵션이 좋다(추가 제품을 구하고 다른 시스템의 데이터를 통합하기 쉽다)

- NoSQL   
    - 스키마가 없기에 유연하게 작성 가능하다   

    - 데이터가 애플리케이션이 필요로하는 형태로 저장되어 읽는 속도가 빠르다   
    - 빅데이터 분석을 처리하는데 탁월하다   
    - 저장 가능한 데이터 유형에 제한이 없다   
    - 데이터를 준비할 필요가 없다

---
### 단점
- 관계형 데이터베이스(RDBMS)  
    - 다른 DBMS보다 더 많은 자원이 활용되어 시스템의 부하가 높다
    - 확장성 문제와 샤딩의 어려움이있다
    > 샤딩은 관리가 쉽도록 큰 데이터베이스를 작은 부분으로 나누는 프로세스이다
    - NoSQL 형식으로 효율성이 떨어진다

- NoSQL(비관계형 DBMS)   
    - 유연성으로 인한, 데이터 구조 결정이 늦춰질 수 있다   
    - 데이터가 여러 컬렉션에 중복되어있어, 수정(Update)해야하는 경우 모든 컬렉션에서 수행하여야한다
    - 지원 받기 어렵다
    - 툴이 부족하다
    - 호환성 및 표준화문제가 있다
    > 비관계형 데이터베이스 관리 시스템의 데이터가 다른 제품및 서비스와 쉽게 통합되지 않는 것을 확인 할 수 있다

---
### 적합한 데이터베이스 유형을 선택하는 방법
1. 원자성   
원자성이 최우선 순위인 경우 관계형 데이터베이스를 사용하는것이 좋다   
데이터베이스 관리의 원자성은 데이터 베이스의 일관성을 향상 시키고, 원자성 트랜잭션의 원칙에 의존한다
> 원자성(Atomicity) : 트랜잭션과 관련된 일은 모두 실행되던지 모두 실행되지 않도록 하던지를 보장하는 특성

2. 수직 또는 수평 확장   
데이터 전략이 수직 확장을 기초로 하는 경우 관계형 데이터베이스가 바람직하다   
수직확장은 시스템에 더 많은 서버를 추가하는 대신 서버에 더 많은 컴퓨팅 능력을 추가한다 사용자 수가 제한적이고 관련된 쿼리가 많지 않은 경우 선호된다    수직확장의 기본적인 장점은 속도와 단순성이다<br><br>
반면 사용자나 쿼리 측면에서 더 큰 부하가 예상되는 경우 수평 확장이 훨씬 저렴한 솔루션이다   
 NoSQL 데이터베이스는 수평 확장을 사용한다   
수평확장과 NoSQL 데이터베이스는 비즈니스에 더 많은 탄력성을 제공한다 그러나 이 시스템에서는 결합 작업을 실행하는 것이 어렵다

3. 속도   
ACID 준수보다 속도가 더 중요한 경우 문서 데이터베이스와 같은 비관계형 데이터베이스가 더 나은 적합하다
> ACID : 데이터베이스 트랜잭션이 안전하게 수행된다는 것을 보장하기 위한 성질
>> Atomoicity(원자성)   
Consistency(일관성)   
Isolation(독립성)   
Durability(지속성)   
>>> 트랜잭션 : 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 논리적 단위
---

### MySQL(RDBMS) NoSQL 복합 시스템 구축
1. 복합시스템 설계
- Application Side Join
```
기존 시스템은 모든 종류의 데이터를 모두 RDBMS에 저장하고 처리하였다
그로인해 우선순위가 낮은 빅데이터 때문에 데이터의 처리가 지연되는 문제가 발생하게됨

NoSQL을 도입하여 우선순위가 낮고 대량의 트랜젝션을 발생시키는 데이터들을 NoSQL에서 처리
-> RDBMS는 중요한 데이터 처리에만 집중할 수 있기 때문에 쾌적한 환경에서 최상의 결과를 만들어냄
```
- `데이터의 성격`에 따라 RDBMS와 NoSQL로 `분산하여 처리`하여 `전체 시스템의 퍼포먼스가 향상`되는 장점을 가진다
- 여러 DB에 나뉘어 있는 데이터를 프로그램상으로 불러와서 JOIN한다
    - 이를 `Application Side Join`이라고 한다


- Data Export / Import
```
RDBMS/NoSQL에 저장된 데이터를 Hadoop 에서 처리를 하려면 HDFS 상에 파일 형태로 변환해주어야한다
이때 다양한 DBMS/NoSQL의 데이터를 HDFS로 Import/Export 해주는 'Sqoop'과 같은 Hadoop Echosystem을 사용해야한다
```
- 정형화된 데이터 처리
    - Sqoop, hiho
- 비정형화된 데이터 처리
    - Flume, Scribe
- Batch Processing
    - 빅데이터 분석 시, 자동화된 병렬처리/ 분산처리를 지원하는 MapReduce을 많이 사용하며 대표적인 솔루션이 `Hadoop`이다
    - Haddop은 `배치형 데이터 처리 시스템`이며 `Map단계와 Reduce단계를 순차적으로 실행`하여 결과를 만든다

2. 빅데이터 수집/ 가공/ 서비스 과정
- 데이터 수집
    - 다양한 서비스에서 제공되는 RESTful API를 사용하여 데이터 수집한다(JSON, XML)
    - 스크래핑(크롤링)을 사용하여 데이터 수집한다(HTML)
    - 데이터 수집 자동화를 위해 전용 로봇을 만들어서 주기적으로 실행한다
    - 수집되는 데이터의 양이 많고, 수집 속도가 빠르기 때문에 수집되는 데이터는 NoSQL에 저장할 것을 권장한다

- 데이터 분석
    - 1차적으로 수집된 데이터는 Hadoop을 이용하여 데이터 가공하는 작업을 진행하기 위해 HDFS상에 Import시킨다

    - 분석 작업을 위해 프로그래밍 된 Hadoop 프로그램을 주기적으로 실행시켜서 최신 분석 결과를 생성한다
    - 생성된 분석 결과는 사용자에게 서비스할 때 사용되는 데이터베이스에서 사용될 수 있는 형태의 데이터로 Export 시킨다
    - 데이터를 수집하고, 수집된 데이터를 분석하는 데에는 일정한 시간이 소요되기 때문에, 실시간 처리는 물리적으로 불가능함
    - 다만, 데이터 분석 주기를 최대한 짧게 함으로써 실시간에 가까운 최신 데이터를 사용할 수 있도록 만들어주는것이 현실적이다

- 결과 데이터 서비스
    - 결과 데이터를 RDBMS에 저장해준다
    - RDBMS가 직접 연산을 하지 않고 저장하고 필요시 제공만하기 때문에 오버헤드가 적다
    - Hadoop이 주기적으로 실행되면서 최신데이터를 계속 갱신해주기 때문에 저장된 데이터를 제공하는 것만 신경 쓰면된다

3. 다중 플랫폼 지원 채팅 서비스 구축 사례
- Redis (Remote Dictionary Server)
    - 메모리 기반의 key-Value 타입 저장소이다
    - NoSQL

    - 데이터 구조 서버라고 불린다
    데이터 로딩할 때 시간 절약을 위한 메모리 캐시와 같은 용도로 많이 사용된다
    - 단순히 메모리에 Read/Write 하기만 하는 것이 아니라 정기적으로 메모리를 디스크에 저장하기 때문에 자동 복원도 가능하다
    - 데이터베이스이기 때문에 대부분의 플랫폼에서 지원이 용이하다

- Socket.io
    - node.js에 기반한 라이브러리

    - 실시간 어플리케이션 구현을 위한 크로스 브라우저용 웹 소켓
    - 대부분의 브라우저를 모두 지원한다
    - WebSocket, 등 리얼타임 기술들을 모두 지원한다
    - SocketIO는 클라이언트를 위한 JavaScript용과 서버를 위한 nodeJS용을 따로 배포한다
    - npm을 이용해서 간단하게 설치할 수 있다
    > npm (Node Package Manager) : JavaScript 및 세계 최대의 소프트웨어 레지스트리 패키지 관리자로 Node.js를 설치하면 같이 설치되어 사용할 수 있다

- 데이터 베이스
    - 사용자 계정 정보를 비롯한 중요한 정보는 MySQL에 저장한다

    - RDBMS는 오랜기간 사용되어왔기 때문에 운영 노하우가 풍부하고, 데이터 일관성 유지와 보안등에 유리하다
    - 채팅 서비스를 운영하면서 발생하는 모든 종류의 로그성 데이터는 MongoDB에 저장한다
    > MongoDB는 로그 데이터와 같이 대량으로 빠르게 저장해야하는 데이터에 적합하고, 데이터베이스의 확장이 용이하기 때문에 용량에 상관없이 저장이 가능하다